@model IEnumerable<JobPortal.Areas.Shared.Models.job_application>

@{
    Layout = "_LayoutDashboard";
    ViewData["Title"] = "Applications";
}

<link rel="stylesheet" href="~/css/dashboard.css" />

<section class="my-applications-section">
    <h1 class="page-title">My Applications</h1>

    <div class="applications-table-container">
        <table class="applications-table">
            <thead>
                <tr>
                    <th>Job Title</th>
                    <th>Company</th>
                    <th>Location</th>
                    <th>Industry</th>
                    <th>Salary Range</th>
                    <th>Last Updated</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @if (!Model.Any())
                {
                    <tr>
                        <td colspan="7" class="text-center">You haven’t applied to any jobs yet.</td>
                    </tr>
                }
                else
                {
                    foreach (var app in Model)
                    {
                        var job = app.job_listing;
                        var company = job?.company;

                        <tr>
                            <td>@job?.job_title</td>
                            <td>@company?.company_name</td>
                            <td>@company?.company_location</td>
                            <td>@company?.company_industry</td>
                            <td>
                                @if (job?.salary_min != null && job?.salary_max != null)
                                {
                                    @:RM @job.salary_min - RM @job.salary_max
                                }
                                else
                                {
                                    @:Not specified
                                }
                            </td>
                            <td>@app.date_updated.ToString("yyyy-MM-dd HH:mm")</td>
                            <td>
                                <span class="status status-@app.application_status.ToLower().Replace(" ", "")">
                                    @app.application_status
                                </span>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>

    <div class="pagination">
        @if (ViewBag.TotalPages > 1)
        {
            <button disabled="@(ViewBag.CurrentPage == 1)"
                onclick="location.href='@Url.Action("Applications", new { page = ViewBag.CurrentPage - 1 })'">
                ⬅ Previous
            </button>

            <span>Page @ViewBag.CurrentPage of @ViewBag.TotalPages</span>

            <button disabled="@(ViewBag.CurrentPage == ViewBag.TotalPages)"
                onclick="location.href='@Url.Action("Applications", new { page = ViewBag.CurrentPage + 1 })'">
                Next ➡
            </button>
        }
        else
        {
            <span>Showing all @Model.Count() applications</span>
        }
    </div>

</section>