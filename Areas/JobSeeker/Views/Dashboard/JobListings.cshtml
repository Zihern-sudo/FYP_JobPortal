@model IEnumerable<JobPortal.Areas.Shared.Models.job_listing>

@{
    Layout = "_LayoutDashboard";
    ViewData["Title"] = "Job Listings";
}

<link rel="stylesheet" href="~/css/dashboard.css" />

<section class="job-listings-section">
    <div class="header-bar">
        <h1 class="page-title">Available Job Listings</h1>
        <button class="favourite-btn">‚≠ê Favourited</button>
    </div>

    <!-- üîç Filter Bar -->
    <form asp-action="JobListings" method="get" class="job-filter-bar d-flex flex-wrap gap-2 align-items-center">
        <!-- Keyword Search -->
        <input type="text" name="search" class="form-control w-auto" placeholder="Search jobs or companies..."
            value="@ViewBag.Search" />

        <!-- üìç Location Filter -->
        <select name="location" class="form-select w-auto">
            <option value="">All Locations</option>
            @foreach (var loc in ViewBag.Locations as List<string>)
            {
                <option value="@loc" selected="@(ViewBag.Location == loc ? "selected" : null)">@loc</option>

            }
        </select>

        <!-- üí∞ Salary Range -->
        <select name="salaryRange" class="form-select w-auto">
            <option value="">All Salaries</option>
            <option value="0-500" selected="@(ViewBag.SalaryRange == "0-500" ? "selected" : null)">Below RM500</option>
            <option value="500-1000" selected="@(ViewBag.SalaryRange == "500-1000" ? "selected" : null)">RM500 - RM1000</option>
            <option value="1000-1500" selected="@(ViewBag.SalaryRange == "1000-1500" ? "selected" : null)">RM1000 - RM1500</option>
            <option value="1500-2000" selected="@(ViewBag.SalaryRange == "1500-2000" ? "selected" : null)">RM1500 - RM2000</option>
            <option value="2000-2500" selected="@(ViewBag.SalaryRange == "2000-2500" ? "selected" : null)">RM2000 - RM2500</option>
            <option value="2500-3000" selected="@(ViewBag.SalaryRange == "2500-3000" ? "selected" : null)">RM2500 - RM3000</option>
            <option value="3000-3500" selected="@(ViewBag.SalaryRange == "3000-3500" ? "selected" : null)">RM3000 - RM3500</option>
            <option value="3500-4000" selected="@(ViewBag.SalaryRange == "3500-4000" ? "selected" : null)">RM3500 - RM4000</option>
            <option value="4000-10000" selected="@(ViewBag.SalaryRange == "4000-10000" ? "selected" : null)">Above RM4000</option>

        </select>

        <!-- üéì Internship Type (placeholder) -->
        <select name="internshipType" class="form-select w-auto">
            <option value="">All Internship Types</option>
        </select>

        <!-- üè† Work Mode (placeholder) -->
        <select name="workMode" class="form-select w-auto">
            <option value="">All Work Modes</option>
        </select>

        <button type="submit" class="btn btn-primary">Filter</button>
    </form>


    <!-- üß© Dynamic Job Listings -->
    <div class="job-listings-container">
        @if (!Model.Any())
        {
            <p>No job listings available.</p>
        }
        else
        {
            @foreach (var job in Model)
            {
                <div class="job-item">
                    <div class="job-info">
                        <h3>@job.job_title</h3>
                        <p class="company">
                            @job.company.company_name
                            <span class="industry">¬∑ @job.company.company_industry</span>
                        </p>
                        <p class="details">
                            @job.company.company_location ¬∑ @job.date_posted.ToString("MMM dd, yyyy") ¬∑ @job.job_status
                        </p>
                        <p class="description">@job.job_description</p>
                    </div>
                    <div class="job-logo">
                        <img src="~/images/company1.png" alt="Company Logo">
                        <a asp-controller="Dashboard" asp-action="JobDetails" asp-route-id="@job.job_listing_id"
                            class="apply-btn">View Details</a>
                    </div>
                </div>
            }

        }
    </div>

    <!-- üìÑ Pagination -->
    @if (ViewBag.TotalPages > 1)
    {
        <div class="pagination">
            <button disabled="@((ViewBag.CurrentPage == 1))"
                onclick="location.href='@Url.Action("JobListings", new { page = ViewBag.CurrentPage - 1, search = ViewBag.Search })'">
                ‚¨Ö Previous
            </button>

            <span>Page @ViewBag.CurrentPage of @ViewBag.TotalPages</span>

            <button disabled="@((ViewBag.CurrentPage == ViewBag.TotalPages))"
                onclick="location.href='@Url.Action("JobListings", new { page = ViewBag.CurrentPage + 1, search = ViewBag.Search })'">
                Next ‚û°
            </button>
        </div>
    }

    else
    {
        <div class="pagination">
            <span>Showing all @Model.Count() jobs</span>
        </div>
    }

</section>