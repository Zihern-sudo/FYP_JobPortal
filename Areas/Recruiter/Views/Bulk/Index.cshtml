@using JobPortal.Areas.Recruiter.Models
@{
  var list = ViewBag.Items as List<CandidateItemVM> ?? new List<CandidateItemVM>();
}

<div class="card shadow-sm">

  <div class="card-body">

    <!-- One form; submit to different endpoints via 'formaction' -->
    <form id="bulkForm" method="post">
      @Html.AntiForgeryToken()

      <div class="d-flex gap-2 mb-3">
        <button type="button" class="btn btn-outline-primary btn-sm"
          onclick='showToast("Bulk messaging (UI coming soon)","primary")'>Message</button>

        <button type="submit" class="btn btn-outline-success btn-sm"
          formaction="@Url.Action("MoveToShortlisted", "Bulk", new { area = "Recruiter" })">
          Move to Shortlisted
        </button>

        <button type="submit" class="btn btn-outline-secondary btn-sm"
          formaction="@Url.Action("ExportCvsZip", "Bulk", new { area = "Recruiter" })">
          Export CVs
        </button>
      </div>

      <table class="table align-middle">
        <thead>
          <tr>
            <th style="width:36px;"></th>
            <th>Name</th>
            <th>Score</th>
            <th>Stage</th>
            <th>Applied</th>
          </tr>
        </thead>
        <tbody>
          @if (list.Any())
          {
            foreach (var c in list)
            {
              <tr>
                <td>
                  <input type="checkbox" name="selectedIds" value="@c.Id" />
                </td>
                <td>@c.Name</td>
                <td>@c.Score</td>
                <td>@c.Stage</td>
                <td>@c.AppliedAt</td>
              </tr>
            }
          }
          else
          {
            <tr>
              <td colspan="5" class="text-muted">No candidates found.</td>
            </tr>
          }
        </tbody>
      </table>
    </form>
  </div>
</div>